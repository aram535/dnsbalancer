# dnsbalancer configuration file
# This is an example configuration with all available options

# Listen address for incoming DNS queries (UDP)
# Requires root privileges or CAP_NET_BIND_SERVICE for port 53
listen: "0.0.0.0:53"

# Timeout for backend DNS queries
timeout: 3s

# Logging configuration
log_level: info  # debug, info, warn, error
log_dir: /var/log/dnsbalancer

# Fail behavior when all backends are unhealthy
# - "closed": Drop queries and don't forward to unhealthy backends
# - "open": Still attempt to forward queries to backends
fail_behavior: closed

# Backend DNS servers
# Queries are distributed using round-robin across healthy backends
backends:
  - address: "192.168.1.2:53"
  - address: "192.168.1.3:53"

# Health checking configuration
health_check:
  # Enable/disable active health checking
  enabled: true
  
  # How often to check each backend
  interval: 10s
  
  # Timeout for health check queries
  timeout: 2s
  
  # Number of consecutive failures before marking backend unhealthy
  failure_threshold: 3
  
  # Number of consecutive successes before marking backend healthy again
  success_threshold: 2
  
  # DNS query to use for health checking
  # "." queries root nameservers (universally supported)
  query_name: "."
  query_type: "NS"  # A, AAAA, NS, or ANY

# GELF logging to Graylog (optional, planned for future release)
# Uncomment to enable when supported
# gelf:
#   enabled: false
#   address: "graylog.example.com:12201"
#   protocol: "tcp"  # tcp or udp
